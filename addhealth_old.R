library(AER)
library(dummies)
library(tidyverse)
load("~/data/ahabuse/data_r/DS0022/21600-0022-Data.rda")
load("~/data/ahabuse/data_r/DS0001/21600-0001-Data.rda")
load("~/data/ahabuse/data_r/DS0031/21600-0031-Data.rda")
WIKeep <- select(da21600.0001, c("AID", "S4", "S5", "S6A", "S6B", "S6C", "S6D", "S6E", "S7", "S12", "S18", "AH_PVT", "PA55", "PA1", "PA2", "PA12", "PB2", "PB8"))
plusWI <- merge(da21600.0022, WIKeep, by="AID")
WIVWeight <- select(da21600.0031, c("AID",  "GSWGT4_2"))
addhealth <- merge(plusWI, WIVWeight, by="AID")
addhealth <- as_data_frame(addhealth)
remove(list = c("da21600.0001", "da21600.0022", "da21600.0031", "WIKeep", "plusWI", "WIVWeight"))

addhealth <- rename(addhealth, income08 = H4EC2)
addhealth <- mutate(addhealth, loginc08 = log(income08))
addhealth <- cbind(addhealth, dummy(addhealth$BIO_SEX4, sep = "_"))
addhealth <- rename(addhealth, female = `addhealth_(2) (2) Female`)
edlvl <- as.integer(addhealth$H4ED2)
edlvl <- Recode(edlvl, "1:2 = 1; 3 = 2; 4:6 = 3; 7:8 = 4; 9:10 = 5; 11 = 6; 12 = 4; 13 = 5")
edlvl <- factor(edlvl, labels = c("noHS", "HS", "someColl", "BA", "MAProf", "PhD"))
